<!DOCTYPE html> <html lang="en"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <link rel="stylesheet" href="/assets/css/just-the-docs-default.css"> <link rel="stylesheet" href="/assets/css/just-the-docs-head-nav.css" id="jtd-head-nav-stylesheet"> <style id="jtd-nav-activation"> .site-nav > ul.nav-list:first-child > li > a, .site-nav > ul.nav-list:first-child > li > ul > li:not(:nth-child(4)) > a, .site-nav > ul.nav-list:first-child > li > ul > li > ul > li a { background-image: none; } .site-nav > ul.nav-list:not(:first-child) a, .site-nav li.external a { background-image: none; } .site-nav > ul.nav-list:first-child > li:nth-child(8) > ul > li:nth-child(4) > a { font-weight: 600; text-decoration: none; }.site-nav > ul.nav-list:first-child > li:nth-child(8) > button svg, .site-nav > ul.nav-list:first-child > li:nth-child(8) > ul > li:nth-child(4) > button svg { transform: rotate(-90deg); }.site-nav > ul.nav-list:first-child > li.nav-list-item:nth-child(8) > ul.nav-list, .site-nav > ul.nav-list:first-child > li.nav-list-item:nth-child(8) > ul.nav-list > li.nav-list-item:nth-child(4) > ul.nav-list { display: block; } </style> <script src="/assets/js/vendor/lunr.min.js"></script> <script src="/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.8.0 --> <title>Testing BamToCov | BamToCov</title> <meta name="generator" content="Jekyll v3.10.0" /> <meta property="og:title" content="Testing BamToCov" /> <meta property="og:locale" content="en" /> <meta name="description" content="BamToCov - alignment coverage tools" /> <meta property="og:description" content="BamToCov - alignment coverage tools" /> <link rel="canonical" href="http://0.0.0.0:4000/notes/tests.html" /> <meta property="og:url" content="http://0.0.0.0:4000/notes/tests.html" /> <meta property="og:site_name" content="BamToCov" /> <meta property="og:type" content="website" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="Testing BamToCov" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebPage","description":"BamToCov - alignment coverage tools","headline":"Testing BamToCov","url":"http://0.0.0.0:4000/notes/tests.html"}</script> <!-- End Jekyll SEO tag --> <style> /* Custom color scheme for bamtocov */ /* Change links from purple to red */ a, a:visited { color: #d40808 !important; } /* Change main text from black to navy and increase font size */ body, .main-content, p, li, td, th, h1, h2, h3, h4, h5, h6 { color: #00023c !important; font-size: 1.15em !important; } /* Navigation styling */ .navigation-list-item .navigation-list-link { color: #d40808 !important; font-size: 1.15em !important; } /* Make parent navigation items (Tools, Scripts, Notes) bold and navy */ .navigation-list-item.navigation-list-item--has-children > .navigation-list-link { font-weight: bold !important; color: #00023c !important; } /* Ensure readability for various elements */ .site-title, .site-title:visited { color: #00023c !important; } /* Code blocks and pre elements */ code, pre { color: #00023c !important; font-size: 1.15em !important; } </style> </head> <body> <a class="skip-to-main" href="#main-content">Skip to main content</a> <svg xmlns="http://www.w3.org/2000/svg" class="d-none"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <!-- Feather. MIT License: https://github.com/feathericons/feather/blob/master/LICENSE --> <symbol id="svg-external-link" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link"> <title id="svg-external-link-title">(external link)</title> <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <!-- Bootstrap Icons. MIT License: https://github.com/twbs/icons/blob/main/LICENSE.md --> <symbol id="svg-copy" viewBox="0 0 16 16"> <title>Copy</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16"> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/> <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/> </svg> </symbol> <symbol id="svg-copied" viewBox="0 0 16 16"> <title>Copied</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard-check-fill" viewBox="0 0 16 16"> <path d="M6.5 0A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3Zm3 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3Z"/> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1A2.5 2.5 0 0 1 9.5 5h-3A2.5 2.5 0 0 1 4 2.5v-1Zm6.854 7.354-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 0 1 .708-.708L7.5 10.793l2.646-2.647a.5.5 0 0 1 .708.708Z"/> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header" role="banner"> <a href="/" class="site-title lh-tight"> BamToCov </a> <button id="menu-button" class="site-button btn-reset" aria-label="Toggle menu" aria-pressed="false"> <svg viewBox="0 0 24 24" class="icon" aria-hidden="true"><use xlink:href="#svg-menu"></use></svg> </button> </div> <nav aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><a href="/installation" class="nav-list-link">Installation</a></li><li class="nav-list-item"><a href="/overview" class="nav-list-link">Overview</a></li><li class="nav-list-item"><a href="/usage" class="nav-list-link">Usage</a></li><li class="nav-list-item"><a href="/examples" class="nav-list-link">Examples</a></li><li class="nav-list-item"><a href="/history" class="nav-list-link">History</a></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Tools category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/tools/" class="nav-list-link">Tools</a><ul class="nav-list"><li class="nav-list-item"><a href="/tools/bamtocov.html" class="nav-list-link">BamToCov</a></li><li class="nav-list-item"><a href="/tools/bamtocounts.html" class="nav-list-link">BamToCounts</a></li><li class="nav-list-item"><a href="/tools/bamcountrefs.html" class="nav-list-link">BamCountRefs</a></li><li class="nav-list-item"><a href="/tools/covtotarget.html" class="nav-list-link">CovToTarget</a></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Scripts category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/scripts/" class="nav-list-link">Scripts</a><ul class="nav-list"><li class="nav-list-item"><a href="/scripts/average-coverage.html" class="nav-list-link">average-coverage.py</a></li><li class="nav-list-item"><a href="/scripts/low-cov-multisample.html" class="nav-list-link">low-cov-multisample.py</a></li><li class="nav-list-item"><a href="/scripts/make-target-from-bam.html" class="nav-list-link">make-target-from-bam.py</a></li><li class="nav-list-item"><a href="/scripts/feat-counts.html" class="nav-list-link">feat-counts.py</a></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Notes category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/notes/" class="nav-list-link">Notes</a><ul class="nav-list"><li class="nav-list-item"><a href="/notes/longreads.html" class="nav-list-link">Long Reads Testing</a></li><li class="nav-list-item"><a href="/notes/memory.html" class="nav-list-link">Memory Usage</a></li><li class="nav-list-item"><a href="/notes/simulations.html" class="nav-list-link">Simulated BAMs</a></li><li class="nav-list-item"><a href="/notes/tests.html" class="nav-list-link">Testing BamToCov</a></li><li class="nav-list-item"><a href="/notes/wig.html" class="nav-list-link">Wig Format</a></li></ul></li><li class="nav-list-item"><a href="/" class="nav-list-link">BamToCov</a></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/just-the-docs/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search" role="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search BamToCov" aria-label="Search BamToCov" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> </div> <div class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="/notes/">Notes</a></li> <li class="breadcrumb-nav-list-item"><span>Testing BamToCov</span></li> </ol> </nav> <div id="main-content" class="main-content"> <main> <h1 id="testing-bamtocov"> <a href="#testing-bamtocov" class="anchor-heading" aria-labelledby="testing-bamtocov"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Testing BamToCov </h1> <h2 id="testing-scenarios"> <a href="#testing-scenarios" class="anchor-heading" aria-labelledby="testing-scenarios"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Testing scenarios </h2> <p>To create minimal examples a set of scripts is provided in <code>scripts/benchmarking/</code> to generate artificial BAM files.</p> <p>Some examples are provided in the repository (with screenshots):</p> <ul> <li><a href="https://github.com/telatin/bamtocov/tree/main/input/tiny#readme">Target (1 chromosome, 3 features)</a></li> <li><a href="https://github.com/telatin/bamtocov/tree/main/input/artificial#readme">3 chromosomes, 1 feature each</a></li> </ul> <h2 id="test-suite"> <a href="#test-suite" class="anchor-heading" aria-labelledby="test-suite"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Test suite </h2> <p>The program default test suite can be invoked by:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>make <span class="nb">test</span>
</code></pre></div></div> <p>An extended (and redundant) set of tests can be run with:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>make testall
</code></pre></div></div> <p>This runs both the default tests, plus a legacy Bash script</p> <h3 id="shpec-tests"> <a href="#shpec-tests" class="anchor-heading" aria-labelledby="shpec-tests"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Shpec tests </h3> <p>The default test suite was written using the <a href="https://github.com/rylnd/shpec">Shpec</a> framework, and can be individually run as:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Same as "make test"</span>
./tests/bin/shpec ./tests/shpec/bamtocov.sh
</code></pre></div></div> <p>And will produce an indented output covering the binaries tested, similar to the example below:</p> <div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Make test
  BamToCov
    Binary exist
    Version emitted is 2.x
    Mini coverage, verify output line number
    One line with empty chromosome seq0 (empty chromosome)
    Works with sorted file
    Fails with unsorted file
    Produces wig output (check lines)
    Produces wig output (check lines at 750)
    Produces wig output (check lines at 1000 bases, unexpected)
    Produces wig output header
  BamToCounts
    Binary exists
    Version 2.x
    Counts target
    Coverage check(x6)
14 examples, 0 failures
</code></pre></div></div> <h3 id="legacy-test-suite"> <a href="#legacy-test-suite" class="anchor-heading" aria-labelledby="legacy-test-suite"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Legacy test suite </h3> <p>A minimal test suite is provided in <code>tests/all.sh</code>. The output will show the passing and failing tests as well as a check on the versions (ensuring that the current development version is different from the released one):</p> <div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>PASS: covtobed style output, lines
PASS: covtobed style output, MD5
PASS: target report, tabcheck 
PASS: Current nimble version is different from GitHub release (should be newer)
PASS: Nimble version matches binary
Checking version for bamcountrefs: 2.2.1
Checking version for bamtocounts: 2.2.1
Checking version for bamtocov: covtobed 2.2.1
Checking version for covtotarget: 2.2.1
--------------------------
SUMMARY (PASS=11,FAIL=0)
Last release:    v2.1.0
Current release: v2.2.1
Binary release:  v2.2.1
--------------------------
FINAL RESULT: PASS
</code></pre></div></div> </main> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
